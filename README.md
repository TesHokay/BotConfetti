# Confetti Telegram Bot

Телеграм-бот для студии преподавания французского языка «Конфетти». Проект реализован на Python с использованием библиотеки `python-telegram-bot` и хранением данных в SQLite.

## Возможности

### Для студентов
- Приветствие и главное меню с двуязычными разделами (русский/французский).
- Просмотр информации о студии, преподавателях, расписании и контактах.
- Запись на пробный урок с пошаговым диалогом: имя, контакт, желаемая дата, пожелания.
- Загрузка скриншота оплаты. Данные автоматически сохраняются в базе.

### Для администраторов
- Авторизация по списку `chat_id` (указать в `.env`).
- Панель администратора с кнопками:
  - Рассылка сообщений всем пользователям (копия исходного сообщения).
  - Просмотр заявок в табличном виде.
  - Редактирование текста разделов: расписание, о студии, преподаватели, контакты.
- Все заявки и платежи хранятся в SQLite и доступны для выгрузки.

## Структура проекта
```
BotConfetti/
├── bot_confetti/
│   ├── config.py
│   ├── database.py
│   ├── keyboards/
│   ├── messages.py
│   ├── services/
│   └── utils/
├── data/ (создаётся автоматически)
├── main.py
├── requirements.txt
└── .env.example
```

## Подготовка окружения

1. Создайте и активируйте виртуальное окружение:
   ```bash
   python3 -m venv .venv
   source .venv/bin/activate  # Windows: .venv\\Scripts\\activate
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Скопируйте файл `.env.example` в `.env` и заполните значения:
   - `BOT_TOKEN` — токен бота от @BotFather.
   - `BOT_ADMIN_IDS` — список chat_id администраторов через запятую (узнать через @userinfobot).
   - при необходимости можно изменить путь к базе данных (`BOT_DATABASE`).

> ⚠️ **Ручные действия:** обязательно впишите актуальный `BOT_TOKEN` и `BOT_ADMIN_IDS` перед запуском.

## Запуск

```bash
python main.py
```

Бот начнёт polling и готов к работе. Остановите сочетанием `Ctrl+C`.

## Работа с данными

- База данных расположена по умолчанию в `data/confetti.sqlite`.
- Таблицы: `users`, `bookings`, `payments`, `content`.
- Записи можно просматривать стандартными инструментами SQLite.

## Дополнительные заметки

- При рассылке бот копирует исходное сообщение администратора (текст/медиа) всем зарегистрированным пользователям.
- Даты заявок валидируются по формату `ДД.ММ.ГГГГ` без указания времени, как и требовалось.
- Контент разделов можно обновлять прямо из Телеграм через панель администратора.
